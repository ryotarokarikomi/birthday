name: test
on:
  push:
    branches:
      - main
    paths-ignore:
      - '**.md'
  pull_request:
    branches:
      - main
    paths-ignore:
      - '**.md'

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    container: osrf/ros:humble-desktop
    strategy:
      matrix:
        rosdistro:
          - humble

    steps:
      - name: Check out repository
        uses: actions/checkout@v3

      - name: Apt update
        run: |
          sudo apt update -y

      - name: test
        run: |
	  rysync -av ./ /root/ros2_ws/src/mypkg/
          cd root/ros2_ws/
          rosdep update
          rosdep install -r -y --from-paths --ignore-src ./
	  bash -xv ./src/mypkg/test/test.bash /root
        shell: bash
